<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMDBweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQgbWVldCIgdmlld0JveD0iMCAwIDQzNiAyMTIiPjxwYXRoIGNsYXNzPSJsb2dvX19waHAiIGQ9Ik04Ni41NzQ5OTcgNjkuNDc0OTk4bC00Ni4wMTg5OTcgMGwtMTkuOSAxMDAuNzQzOTk2bDIzLjYzMDk5OSAwbDQuOTc1MDAyIC0yNi4xMTg5ODhsMjIuMzg4IDBjMjEuMTQzOTk3IDEuMiA0NC44IC0xNi4yIDQ0LjggLTQ2LjAxOTAwNWMwLjAwMDk5OSAtMTcuNCAtOS45IC0yNy40IC0yOS44IC0yOC42MDYwMDN6bS0xNy40MTI5OTQgNTUuOTY4MDAybC0xNC45MjUwMDMgMGw2LjIxOTAwMiAtMzcuMzEyMDA0bDE2LjE2ODk5OSAwYzguNzA2MDAxIDAgMTQuOSAzLjcgMTQuOSAxMS4xOTRjLTEuMjQzMDA0IDIxLjEgLTExLjIgMjQuOSAtMjIuNCAyNi4xMTgwMDR6IE0xMTEuOTYyOTk3IDE0NC4xMDAwMDZsMTkuODk5MDAyIC0xMDAuNzQyOTk2bDIzLjYzMjAwNCAwbC00Ljk3NTk5OCAyNi4xMTkwMDNsMjIuMzg4IDBjMTkuODk5OTk0IDEuMiAyNy40IDExLjIgMjQuOSAyMy42MzA5OTdsLTguNzA2MDA5IDUwLjk5Mjk5NmwtMjQuODc1IDBsOC43MDYwMDkgLTQ2LjAxODk5N2MxLjI0Mzk4OCAtNi4yIDEuMiAtOS45IC03LjUgLTkuOTQ5OTk3bC0xOC42NTU5OTEgMGwtMTEuMTkzMDA4IDU1Ljk2ODk5NGwtMjMuNjMwOTk3IDB6IE0yNTUuMjM3IDY5LjQ3NDk5OGwtNDYuMDE4OTk3IDBsLTE5LjkwMDAwOSAxMDAuNzQzOTk2bDIzLjYzMjAwNCAwbDQuOTc1MDA2IC0yNi4xMTg5ODhsMjIuMzg4IDBjMjEuMTQzOTk3IDEuMiA0NC44IC0xNi4yIDQ0LjggLTQ2LjAxOTAwNWMwIC0xNy40IC0xMCAtMjcuNCAtMjkuOSAtMjguNjA2MDAzem0tMTcuNDEyMDAzIDU1Ljk2ODAwMmwtMTQuOTI1MDAzIDBsNi4yMTg5OTQgLTM3LjMxMjAwNGwxNi4xNjc5OTkgMGM4LjcwNzAwMSAwIDE0LjkgMy43IDE0LjkgMTEuMTk0Yy0xLjI0Mzk4OCAyMS4xIC0xMS4yIDI0LjkgLTIyLjQgMjYuMTE4MDA0eiIgZmlsbD0iIzFFMUUxRSI+PC9wYXRoPjxnIGNsYXNzPSJsb2dvX19zdyI+PHBhdGggY2xhc3M9ImxvZ29fX3N3X19yaG9tYm9pZCIgZD0iTTQxNC40OTgxNjkgMTQyLjM3NWwtMTE1Ljk5ODE2OSAwbDEyLjUgLTc1bDExNiAwIiBmaWxsPSIjMkE4RUJEIj48L3BhdGg+PHBhdGggY2xhc3M9ImxvZ29fX3N3X190ZXh0IiBkPSJNMzE3LjU1ODc3NyAxMTguMDI1MDAyYzIuNzY0MDA4IDEuNyA2LjYgMyAxMSAyLjk3MTAwMWMzLjgwMDAxOCAwIDcuMyAtMS44IDcuMyAtNS4zODljMCAtMi43IC0yIC00LjQgLTYuMyAtNi42MzMwMDNjLTQuOTA0OTk5IC0yLjYgLTkuNiAtNi40IC05LjYgLTEyLjM2Nzk5NmMwIC05LjQgOC4yIC0xNS4xIDE4LjMgLTE1LjEzMTAwNGM1LjU5NzAxNSAwIDguOSAxLjIgMTAuOSAyLjI3OTk5OWwtMy4xMDgwMDIgOC4yOTFjLTEuNTIwOTk2IC0wLjggLTQuOCAtMi4xIC04LjYgLTIuMDAzOTk4Yy00LjYyOTAyOCAwIC03IDIuMyAtNyA0LjgzNjk5OGMwIDIuOCAyLjggNC40IDYuOCA2LjYzMzAwM2M1LjY2NTAwOSAzIDkuMiA2LjggOS4yIDEyLjM2Njk5N2MwIDEwLjQgLTguNiAxNS43IC0xOC45IDE1LjY4NDAwNmMtNi40MjU5OTUgLTAuMSAtMTEuMSAtMS43IC0xMy4zIC0zLjMxNjAwMmwzLjMxNzk5MyAtOC4yMjJ6IE0zNTcuNTYwNzYgMTI4LjgwNDAwMWwtMS43OTU5OSAtNDYuNTY4MDAxbDEwLjA4NzAwNiAwbDAgMjAuNzI3OTk3YzAgNS43IC0wLjEgMTAuOSAtMC4zIDE1LjEzMTAwNGwwLjEzOCAwYzEuNjU4MDIgLTQuNiAzLjMgLTkuMyA1LjUgLTE0Ljk5MzAwNGw4LjM2MDAxNiAtMjAuODY1OTk3bDEwLjkxNjk5MiAwbC0wLjEzOTAwOCAyMC43OTU5OThjLTAuMDY5IDUuNiAtMC4yIDEwLjIgLTAuNSAxNC43ODYwMDNsMC4xMzggMGMxLjU4OTk5NiAtNC44IDMuMyAtOS44IDUuMiAtMTQuODU0MDA0bDguMDE1OTkxIC0yMC43Mjc5OTdsMTAuNTAyMDE0IDBsLTIwLjUyMDk5NiA0Ni41NjgwMDFsLTEwLjg0ODk5OSAwbC0wLjI3NjAwMSAtMTkuMDY5Yy0wLjA2OSAtNS41IDAuMSAtMTAuMiAwLjMgLTE1LjQ3Njk5N2wtMC4xMzkwMDggMGMtMS42NTc5OSA1IC0zLjMgMTAgLTUuNiAxNS42ODM5OThsLTguMDE1OTkxIDE4Ljg2MmwtMTEuMDU0MDE2IDB6IiBmaWxsPSJ3aGl0ZSI+PC9wYXRoPjwvZz48L3N2Zz4=">

# PHPSW Website
<a href="https://circleci.com/gh/phpsw/phpsw-ng"><img src="https://circleci.com/gh/phpsw/phpsw-ng.svg?style=shield&circle-token=210ad69b49f17f455c92532edc96728d5c12b353"></a>

## Requirements
- Ansible 2.x (http://docs.ansible.com/ansible/intro_installation.html)
- Vagrant (https://www.vagrantup.com/docs/installation/)
- NFS

## Getting started
1. Create a mapping in your hosts file from phpsw.local to 192.168.42.10.
1. `vagrant up`
1. `vagrant ssh`
1. `cd /vagrant`
1. `yarn install` (to install NPM dependencies).
1. `cp app/config/secrets_template.yml app/config/secrets.yml`
1. Update `app/config/secrets.yml` with your Meetup API key (not this is only needed if you want to use the entity generation scripts with meetup)

## General Usage
To run the commands use ```/vagrant/runner.php```

### Validate data

To validate data: ```./runner.php  phpsw:validate-data```


### Generate data
There are a number of scripts to help generate the JSON data files. You can supply a meetup id and it will pull the data from meetup.

- **Generate person:** ```./runner.php  phpsw:generate-file-person <meetup-id>``` (meetup ID is optional, used to pull down as much data from Meetup as is available)

- **Generate event:** ```./runner.php  phpsw:generate-file-event <meetup-id>```

- **Generate _all_ event files:** ```./data/scripts/generate-events.sh``` (run from the data/scripts/ dir)

This script calls the `phpsw:generate-file-event` command for each event meetup ID from the list defined within. 

Files are saved in data/events/**generated**/\<year\>/\<month\>/\<event-slug\>.json .

- **Generate a stub talk file:** ```./runner.php  phpsw:generate-file-talk <meetup-id>``` (Pulls down the full description of the given event from meetup and saves it in a file alongside the event slug name. Makes it easier to extract talks from that.)

- **Generate _all_ talk stub files:** ```./generate-talk-file-stubs.sh``` (run from the data/scripts/ dir)

This script calls the `phpsw:generate-file-talk` command for each event meetup ID from the list defined within. 

Files are saved in data/talks/**generated**/\<year\>/\<month\>/\<event-slug\>.json .

### Build website

To generate website run the following steps on the VM

1. `cd /vagrant`
1. ```./runner.php  phpsw:generate-website```
1. `yarn run encore dev` or `yarn run encore dev --watch` to generate and watch. 



## Viewing generated content
Once you've generated the website point your broswer to (http://phpsw.local)

This assumes:

- VM is running
- local hosts is setup (see getting started)


## CI
Execute ```ci/run.sh``` from within the VM to run the CI tests locally.


## Architecture
See the architecture.md file in the app directory for details on architecture. 
